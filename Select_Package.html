<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Select Package — Franchise v2</title>
    <style>
        *{box-sizing:border-box;margin:0;padding:0}
        :root{--bg:#f7f8fb;--card:#fff;--accent:#0b69ff;--muted:#6b7280;--success:#10b981}
        body{font-family:Inter,Segoe UI,system-ui,-apple-system,Roboto,"Helvetica Neue",Arial;color:#111;background:var(--bg);}
        .container{max-width:1200px;margin:48px auto;padding:28px}
        .header{text-align:center;margin-bottom:28px}
        h1{font-size:28px;color:#0f172a;margin-bottom:6px}
        .subtitle{color:var(--muted);font-size:15px}
        .groups{display:flex;gap:22px;align-items:flex-start;flex-wrap:wrap;margin-top:28px}
        .group{flex:1 1 520px;background:transparent;padding:6px}
        .group-header{background:var(--card);border-radius:12px;padding:18px;border:1px solid #edf2f7}
        .group h2{font-size:18px;margin:0;color:#0f172a}
        .group p{margin-top:8px;color:#475569;font-size:14px}
        .plans-wrap{display:flex;justify-content:center;margin-top:18px}
        .plans-grid{display:flex;gap:18px;align-items:stretch}
        .plan-card{width:320px;background:var(--card);border-radius:12px;padding:24px;border:1px solid #e6edf3;cursor:pointer;transition:transform .18s ease,box-shadow .18s ease, border-color .18s ease;position:relative;display:flex;flex-direction:column}
        .plan-card:hover{transform:translateY(-8px);box-shadow:0 18px 40px rgba(15,23,42,0.08)}
        .plan-card.selected{border-color:var(--accent);box-shadow:0 22px 48px rgba(11,105,255,0.08)}
        .plan-name{font-weight:700;font-size:16px;color:#0b1220;margin-bottom:6px}
        .plan-price{font-weight:800;font-size:28px;color:var(--accent);margin-bottom:6px}
        .plan-price small{font-size:12px;color:var(--muted);font-weight:600;margin-left:6px}
        .plan-period{color:var(--muted);margin-bottom:12px}
        .plan-features{list-style:none;margin:0;padding:0;margin-top:auto}
        .plan-features li{padding:8px 0;color:#334155;display:flex;align-items:center}
        .plan-features li::before{content:'\2713';display:inline-block;color:var(--success);font-weight:700;width:20px;margin-right:8px}
        .plan-footer{display:flex;justify-content:space-between;align-items:center;margin-top:18px}
    .btn{padding:14px 28px;border-radius:8px;border:none;font-weight:700;cursor:pointer;font-size:16px}
    .btn-outline{background:transparent;color:#6c757d;border:2px solid #6c757d;padding:14px 28px;border-radius:8px}
    .btn-outline:hover{background:#6c757d;color:#fff}
    .btn-primary{background:#007bff;color:white;padding:14px 28px;border-radius:8px;box-shadow:0 6px 18px rgba(11,105,255,0.12);border:none}
    .btn-primary:hover{background:#0056b3}
        .tag{position:absolute;top:12px;right:12px;background:var(--success);color:#fff;padding:6px 12px;border-radius:999px;font-size:12px;font-weight:700}
        .note{background:#fff;border:1px solid #dbeafe;padding:12px;border-radius:8px;margin-top:20px;color:#334155}
        .controls{display:flex;gap:12px;justify-content:center;margin-top:20px}
        .muted{color:var(--muted)}
        @media (max-width:900px){.groups{flex-direction:column}.plans-grid{flex-direction:column;align-items:center}.plan-card{width:92%}}
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Choose a package</h1>
            <div class="subtitle">Select one package to start creating your tenant — Franchisor plans and Single-store plans are shown below.</div>
        </div>

        <div class="groups">
            <div class="group" id="franchisorGroup">
                <div class="group-header">
                    <h2>Franchisor plans</h2>
                    <p>For brands that manage multiple franchise locations. Includes tools to invite and manage franchise units and franchisee administrators.</p>
                </div>
                <div class="plans-wrap">
                    <div class="plans-grid">
                        <div class="plan-card" data-type="franchisor" data-plan="starter" onclick="selectCard(this)">
                            <div class="plan-name">Starter</div>
                            <div class="plan-price">$49 <small>/mo</small></div>
                            <ul class="plan-features">
                                <li>Up to 5 franchisees</li>
                                <li>Basic reporting</li>
                                <li>Email support</li>
                                <li>Mobile app access</li>
                                <li>Standard integrations</li>
                            </ul>
                        </div>

                        <div class="plan-card" data-type="franchisor" data-plan="professional" onclick="selectCard(this)">
                            <div class="tag">Most Popular</div>
                            <div class="plan-name">Professional</div>
                            <div class="plan-price">$99 <small>/mo</small></div>
                            <ul class="plan-features">
                                <li>Up to 25 franchisees</li>
                                <li>Advanced analytics</li>
                                <li>Priority support</li>
                                <li>Custom branding</li>
                                <li>All integrations</li>
                                <li>API access</li>
                            </ul>
                        </div>

                        <div class="plan-card" data-type="franchisor" data-plan="enterprise" onclick="selectCard(this)">
                            <div class="plan-name">Enterprise</div>
                            <div class="plan-price">$199 <small>/mo</small></div>
                            <ul class="plan-features">
                                <li>Unlimited franchisees</li>
                                <li>White-label solution</li>
                                <li>Dedicated support</li>
                                <li>Custom development</li>
                                <li>Advanced security</li>
                                <li>SLA guarantee</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="group" id="singleStoreGroup">
                <div class="group-header">
                    <h2>Single-store plans</h2>
                    <p>For a single standalone store. Single-store tenants have no franchisees — this mode hides multi-location and franchise administration features.</p>
                </div>
                <div class="plans-wrap">
                    <div class="plans-grid">
                        <div class="plan-card" data-type="single" data-plan="basic" onclick="selectCard(this)">
                            <div class="plan-name">Basic</div>
                            <div class="plan-price">$19 <small>/mo</small></div>
                            <ul class="plan-features">
                                <li>Up to 5 staff members</li>
                                <li>Basic reporting dashboard</li>
                                <li>Email support</li>
                                <li>Mobile app access</li>
                                <li>Standard integrations</li>
                            </ul>
                        </div>

                        <div class="plan-card" data-type="single" data-plan="standard" onclick="selectCard(this)">
                            <div class="tag">Most Popular</div>
                            <div class="plan-name">Standard</div>
                            <div class="plan-price">$39 <small>/mo</small></div>
                            <ul class="plan-features">
                                <li>Up to 15 staff members</li>
                                <li>Advanced analytics</li>
                                <li>Priority support</li>
                                <li>Custom branding</li>
                                <li>All integrations</li>
                                <li>API access</li>
                            </ul>
                        </div>

                        <div class="plan-card" data-type="single" data-plan="premium" onclick="selectCard(this)">
                            <div class="plan-name">Premium</div>
                            <div class="plan-price">$69 <small>/mo</small></div>
                            <ul class="plan-features">
                                <li>Up to 50 staff members</li>
                                <li>Advanced analytics</li>
                                <li>Dedicated support</li>
                                <li>White-label solution</li>
                                <li>Advanced security</li>
                                <li>Custom integrations</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="actions">
            <a href="account_type_selection.html" class="btn btn-outline">← Back</a>
            <button id="continueBtn" class="btn btn-primary" onclick="continueToPlan()" disabled>Continue →</button>
        </div>

        <div class="note">Tip: pick the package that fits the number of locations/staff you expect. You can change plans later from the tenant billing settings.</div>
    </div>

    <script>
        let selected = null;

        function selectCard(el){
            document.querySelectorAll('.plan-card').forEach(c=>c.classList.remove('selected'));
            el.classList.add('selected');
            selected = { type: el.dataset.type, plan: el.dataset.plan };
            document.getElementById('continueBtn').disabled = false;
            // persist selection for next pages
            localStorage.setItem('selectedPackage', JSON.stringify(selected));

            // also store a small details object subscribe.html expects
            const nameEl = el.querySelector('.plan-name');
            const priceEl = el.querySelector('.plan-price');
            const details = {
                name: nameEl ? nameEl.textContent.trim() : (el.dataset.plan || ''),
                price: priceEl ? priceEl.textContent.trim() : '',
                period: priceEl ? (priceEl.querySelector('small') ? priceEl.querySelector('small').textContent.trim() : '') : ''
            };
            try { localStorage.setItem('selectedPlanDetails', JSON.stringify(details)); } catch(e){}
        }

        function continueToPlan(){
            if(!selected) return alert('Please select a package first.');
            const params = new URLSearchParams({ plan: selected.plan, type: selected.type });

            // preserve from=create if present in current URL or if pendingTenantData exists
            const urlp = new URLSearchParams(window.location.search);
            const fromCreate = urlp.get('from') === 'create' || !!localStorage.getItem('pendingTenantData');
            if(fromCreate) params.set('from','create');

            // redirect to the subscription payment page (subscribe.html) and preserve params
            window.location.href = `subscribe.html?${params.toString()}`;
        }

        // pre-select if user already chose
        const existing = localStorage.getItem('selectedPackage');
        if(existing){
            try{
                const p = JSON.parse(existing);
                const el = document.querySelector(`.plan-card[data-type="${p.type}"][data-plan="${p.plan}"]`);
                if(el) selectCard(el);
            }catch(e){}
        }

        // allow passing preselection via querystring: ?type=franchisor&plan=professional
        const urlp = new URLSearchParams(window.location.search);
        const qType = urlp.get('type');
        const qPlan = urlp.get('plan');
        if(qType && qPlan){
            const el = document.querySelector(`.plan-card[data-type="${qType}"][data-plan="${qPlan}"]`);
            if(el) selectCard(el);
        }
    </script>
</body>
</html>