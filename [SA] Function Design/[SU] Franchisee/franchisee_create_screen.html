<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Franchisee - Super Admin</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f5f7fa; color: #333; line-height: 1.6; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; }
        .back-btn { background: #6c757d; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; text-decoration: none; display: inline-flex; align-items: center; gap: 8px; }
        .back-btn:hover { background: #5a6268; }
        .header h1 { color: #2c3e50; font-size: 24px; }
        .save-btn { background: #007bff; color: white; border: none; padding: 12px 24px; border-radius: 4px; cursor: pointer; font-size: 16px; font-weight: 500; }
        .save-btn:hover { background: #0056b3; }
        .form-container { background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); overflow: hidden; }
        .form-section { padding: 30px; border-bottom: 1px solid #e9ecef; }
        .form-section:last-child { border-bottom: none; }
        .section-title { font-size: 20px; font-weight: 600; color: #2c3e50; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #007bff; }
        .form-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 20px; }
        .form-group { display: flex; flex-direction: column; }
        .form-group.full-width { grid-column: 1 / -1; }
        .form-group.half-width { grid-column: span 1; }
        label { font-weight: 500; margin-bottom: 5px; color: #495057; }
        .required { color: #dc3545; }
        input[type="text"], input[type="email"], input[type="tel"], input[type="url"], input[type="number"], select, textarea { padding: 12px; border: 2px solid #e9ecef; border-radius: 4px; font-size: 14px; transition: border-color 0.3s ease; }
        input:focus, select:focus, textarea:focus { outline: none; border-color: #007bff; box-shadow: 0 0 0 3px rgba(0,123,255,0.1); }
        input.error, select.error, textarea.error { border-color: #dc3545; }
        .error-message { color: #dc3545; font-size: 12px; margin-top: 5px; }
        textarea { resize: vertical; min-height: 80px; }
        .action-buttons { display: flex; gap: 15px; justify-content: flex-end; padding: 20px 30px; background: #f8f9fa; border-top: 1px solid #e9ecef; }
        .btn { padding: 12px 24px; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: 500; text-decoration: none; display: inline-flex; align-items: center; gap: 8px; transition: background-color 0.3s ease; }
        .btn-primary { background: #007bff; color: white; }
        .btn-primary:hover { background: #0056b3; }
        .btn-outline { background: transparent; color: #6c757d; border: 2px solid #6c757d; }
        .btn-outline:hover { background: #6c757d; color: white; }
        .progress-bar { height: 4px; background: #e9ecef; border-radius: 2px; margin-bottom: 20px; overflow: hidden; }
        .progress-fill { height: 100%; background: #007bff; width: 0%; transition: width 0.3s ease; }
        @media (max-width: 768px) { .form-row { grid-template-columns: 1fr; } .action-buttons { flex-direction: column; } .header { flex-direction: column; gap: 15px; text-align: center; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="../[SU] Franchisor Management/Tenant_managment_screen.html" class="back-btn">← Back to Tenant Management</a>
            <h1>Create Franchisee</h1>
            <button class="save-btn" onclick="createFranchisee()">Save & Create</button>
        </div>

        <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
        <div class="error-message" id="errorMessage">❌ Please fix the errors below and try again.</div>

        <form class="form-container" id="franchiseeForm">
            <div class="form-section">
                <h2 class="section-title">Association</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label for="franchisorId">Franchisor <span class="required">*</span></label>
                        <input type="text" id="franchisorSearch" placeholder="Search franchisor..." style="margin-bottom:8px;">
                        <select id="franchisorId" name="franchisorId" required>
                            <option value="">Select Franchisor</option>
                            <!-- These options would come from API in real app -->
                            <option value="1" data-industry="food-beverage">Acme Burgers</option>
                            <option value="2" data-industry="retail">Bright Retail</option>
                            <option value="3" data-industry="services">Care Services Co</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="industryCategory">Industry Category</label>
                        <input type="text" id="industryCategory" name="industryCategory" readonly>
                    </div>
                    <div class="form-group">
                        <label for="businessType">Business Type <span class="required">*</span></label>
                        <select id="businessType" name="businessType" required disabled>
                            <option value="">Select Business Type</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="form-section">
                <h2 class="section-title">Franchisee Information</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label for="franchiseeName">Franchisee Business Name <span class="required">*</span></label>
                        <input type="text" id="franchiseeName" name="franchiseeName" required>
                    </div>
                    <div class="form-group">
                        <label for="franchiseeOwner">Franchisee Owner Name <span class="required">*</span></label>
                        <input type="text" id="franchiseeOwner" name="franchiseeOwner" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="franchiseeEmail">Franchisee Email <span class="required">*</span></label>
                        <input type="email" id="franchiseeEmail" name="franchiseeEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="franchiseePhone">Franchisee Phone <span class="required">*</span></label>
                        <input type="tel" id="franchiseePhone" name="franchiseePhone" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group full-width">
                        <label for="franchiseeAddress">Franchisee Address <span class="required">*</span></label>
                        <input type="text" id="franchiseeAddress" name="franchiseeAddress" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="franchiseeCity">City <span class="required">*</span></label>
                        <input type="text" id="franchiseeCity" name="franchiseeCity" required>
                    </div>
                    <div class="form-group">
                        <label for="franchiseeState">State/Province <span class="required">*</span></label>
                        <input type="text" id="franchiseeState" name="franchiseeState" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="franchiseePostalCode">Postal Code <span class="required">*</span></label>
                        <input type="text" id="franchiseePostalCode" name="franchiseePostalCode" required>
                    </div>
                    <div class="form-group">
                        <label for="franchiseeCountry">Country <span class="required">*</span></label>
                        <select id="franchiseeCountry" name="franchiseeCountry" required>
                            <option value="">Select Country</option>
                            <option value="US">United States</option>
                            <option value="CA">Canada</option>
                            <option value="AU">Australia</option>
                            <option value="GB">United Kingdom</option>
                            <option value="DE">Germany</option>
                            <option value="FR">France</option>
                            <option value="JP">Japan</option>
                            <option value="SG">Singapore</option>
                            <option value="VN">Vietnam</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="form-section">
                <h2 class="section-title">Operational Settings</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label for="openingDate">Opening Date</label>
                        <input type="date" id="openingDate" name="openingDate">
                    </div>
                    <div class="form-group">
                        <label for="numStaff">Initial Staff Count</label>
                        <input type="number" id="numStaff" name="numStaff" min="0" value="0">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="managerName">Manager Name</label>
                        <input type="text" id="managerName" name="managerName">
                    </div>
                    <div class="form-group">
                        <label for="managerEmail">Manager Email</label>
                        <input type="email" id="managerEmail" name="managerEmail">
                    </div>
                </div>
            </div>
        </form>

        <div class="action-buttons">
            <a class="btn btn-outline" href="franchisee_edit_screen.html">Cancel</a>
            <button type="button" class="btn btn-primary" onclick="createFranchisee()">Save & Create</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            document.addEventListener('input', updateProgress);
            document.addEventListener('change', updateProgress);

            const franchisorSelect = document.getElementById('franchisorId');
            const franchisorSearch = document.getElementById('franchisorSearch');
            const industryField = document.getElementById('industryCategory');
            const businessType = document.getElementById('businessType');

            franchisorSelect.addEventListener('change', function() {
                const selected = franchisorSelect.options[franchisorSelect.selectedIndex];
                const industry = selected ? selected.getAttribute('data-industry') : '';
                industryField.value = industry || '';
                updateBusinessTypes(industry);
            });

            // Build in-memory list of franchisors for filtering
            const baseOptions = Array.from(franchisorSelect.options)
                .filter(o => o.value !== '');

            function renderFranchisorOptions(query) {
                const q = (query || '').toLowerCase();
                const matches = baseOptions.filter(o => o.textContent.toLowerCase().includes(q));
                franchisorSelect.innerHTML = '<option value="">Select Franchisor</option>';
                matches.forEach(o => {
                    const opt = document.createElement('option');
                    opt.value = o.value;
                    opt.textContent = o.textContent;
                    const industry = o.getAttribute('data-industry');
                    if (industry) opt.setAttribute('data-industry', industry);
                    franchisorSelect.appendChild(opt);
                });
            }

            franchisorSearch.addEventListener('input', function() {
                renderFranchisorOptions(this.value);
            });
        });

        function updateProgress() {
            const form = document.getElementById('franchiseeForm');
            const inputs = form.querySelectorAll('input[required], select[required], textarea[required]');
            let filledCount = 0;
            inputs.forEach(input => {
                if (input.type === 'checkbox') { if (input.checked) filledCount++; }
                else if ((input.value || '').toString().trim() !== '') { filledCount++; }
            });
            const progress = inputs.length ? (filledCount / inputs.length) * 100 : 0;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function updateBusinessTypes(industryCategory) {
            const businessTypeSelect = document.getElementById('businessType');
            businessTypeSelect.innerHTML = '<option value="">Select Business Type</option>';
            const hasIndustry = industryCategory && industryCategory.trim() !== '';
            if (!hasIndustry) { businessTypeSelect.disabled = true; return; }
            businessTypeSelect.disabled = false;

            const businessTypes = {
                'food-beverage': [
                    { value: 'restaurant-fast-food', text: 'Fast Food Restaurant' },
                    { value: 'restaurant-casual', text: 'Casual Dining Restaurant' },
                    { value: 'restaurant-fine-dining', text: 'Fine Dining Restaurant' },
                    { value: 'cafe-coffee-shop', text: 'Cafe & Coffee Shop' },
                    { value: 'bar-pub', text: 'Bar & Pub' },
                    { value: 'bakery-patisserie', text: 'Bakery & Patisserie' },
                    { value: 'catering', text: 'Catering Services' }
                ],
                'retail': [
                    { value: 'apparel-fashion', text: 'Apparel & Fashion' },
                    { value: 'grocery-supermarket', text: 'Grocery & Supermarket' },
                    { value: 'convenience-store', text: 'Convenience Store' },
                    { value: 'electronics', text: 'Electronics Store' },
                    { value: 'books-media', text: 'Books & Media Store' },
                    { value: 'toys-games', text: 'Toys & Games Store' },
                    { value: 'specialty-retail', text: 'Specialty Retail Store' }
                ],
                'services': [
                    { value: 'gym-fitness', text: 'Gym & Fitness Center' },
                    { value: 'yoga-studio', text: 'Yoga Studio' },
                    { value: 'spa-beauty', text: 'Spa & Beauty Salon' },
                    { value: 'education-tutoring', text: 'Education & Tutoring' },
                    { value: 'childcare', text: 'Childcare Center' },
                    { value: 'automotive-repair', text: 'Automotive Repair Shop' },
                    { value: 'car-wash', text: 'Car Wash Service' },
                    { value: 'accounting', text: 'Accounting Services' },
                    { value: 'consulting', text: 'Consulting Services' },
                    { value: 'real-estate', text: 'Real Estate Agency' }
                ],
                'hospitality': [
                    { value: 'hotel-motel', text: 'Hotel & Motel' },
                    { value: 'travel-agency', text: 'Travel Agency' },
                    { value: 'bed-breakfast', text: 'Bed & Breakfast' },
                    { value: 'hostel', text: 'Hostel' },
                    { value: 'resort', text: 'Resort' }
                ],
                'health-medical': [
                    { value: 'dental-clinic', text: 'Dental Clinic' },
                    { value: 'medical-clinic', text: 'Medical Clinic' },
                    { value: 'pharmacy', text: 'Pharmacy' },
                    { value: 'home-care', text: 'Home Care Services' },
                    { value: 'veterinary', text: 'Veterinary Clinic' },
                    { value: 'mental-health', text: 'Mental Health Services' }
                ],
                'home-garden': [
                    { value: 'home-improvement', text: 'Home Improvement & Repair' },
                    { value: 'landscaping', text: 'Landscaping Services' },
                    { value: 'cleaning-services', text: 'Cleaning Services' },
                    { value: 'pest-control', text: 'Pest Control Services' },
                    { value: 'pool-maintenance', text: 'Pool Maintenance' },
                    { value: 'hvac-services', text: 'HVAC Services' }
                ]
            };

            if (businessTypes[industryCategory]) {
                businessTypes[industryCategory].forEach(type => {
                    const option = document.createElement('option');
                    option.value = type.value;
                    option.textContent = type.text;
                    businessTypeSelect.appendChild(option);
                });
            }
            businessTypeSelect.selectedIndex = 0;
        }

        function validateForm() {
            const form = document.getElementById('franchiseeForm');
            const requiredFields = form.querySelectorAll('input[required], select[required], textarea[required]');
            let isValid = true;
            requiredFields.forEach(field => {
                if (field.type === 'checkbox') { if (!field.checked) { field.classList.add('error'); isValid = false; } else { field.classList.remove('error'); } }
                else if ((field.value || '').toString().trim() === '') { field.classList.add('error'); isValid = false; } else { field.classList.remove('error'); }
            });
            return isValid;
        }

        function createFranchisee() {
            if (!validateForm()) {
                document.getElementById('errorMessage').style.display = 'block';
                return;
            }
            document.getElementById('errorMessage').style.display = 'none';
            alert('Franchisee created successfully!');
        }
    </script>
</body>
</html>
